{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ADMIN\\\\Desktop\\\\hyd\\\\hyd\\\\frontend\\\\src\\\\components\\\\polls\\\\PollList.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { jwtDecode } from 'jwt-decode';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PollList = () => {\n  _s();\n  const [polls, setPolls] = useState([]);\n  useEffect(() => {\n    axios.get(\"http://localhost:5000/api/polls/all\").then(res => setPolls(res.data));\n  }, []);\n  const handleVote = async (pollId, optionIndex) => {\n    try {\n      await axios.post(`http://localhost:5000/api/polls/vote/${pollId}/${optionIndex}`, {}, {\n        headers: {\n          role: localStorage.getItem(\"role\"),\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      alert(\"Vote recorded!\");\n      const res = await axios.get(\"http://localhost:5000/api/polls/all\");\n      setPolls(res.data);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || \"Error voting\");\n    }\n  };\n  const getUserIdFromToken = () => {\n    const token = localStorage.getItem('token');\n    if (!token) return null;\n    try {\n      const decoded = jwtDecode(token);\n      return decoded.userId || decoded._id || decoded.id || null;\n    } catch {\n      return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: \"20px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Available Polls\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this), polls.map(poll => /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: \"1px solid #ddd\",\n        borderRadius: \"8px\",\n        margin: \"10px 0\",\n        padding: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: poll.question\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 11\n      }, this), poll.options.map((opt, idx) => {\n        const votes = opt.votes.length;\n        const totalVotes = poll.options.reduce((sum, o) => sum + o.votes.length, 0);\n        const percent = totalVotes > 0 ? (votes / totalVotes * 100).toFixed(1) : 0;\n        const userId = getUserIdFromToken();\n        const hasVoted = poll.options.some(o => o.votes.includes(userId));\n        const votedThisOption = opt.votes.includes(userId);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: \"5px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleVote(poll._id, idx),\n            style: {\n              marginRight: \"10px\",\n              background: votedThisOption ? '#388e3c' : '#1976d2',\n              color: '#fff',\n              border: 'none',\n              borderRadius: '6px',\n              fontWeight: 600,\n              cursor: 'pointer',\n              display: 'flex',\n              alignItems: 'center'\n            },\n            children: hasVoted ? votedThisOption ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Voted \", /*#__PURE__*/_jsxDEV(\"span\", {\n                title: \"Edit Vote\",\n                style: {\n                  marginLeft: 8,\n                  fontSize: '1.1em',\n                  opacity: 0.7\n                },\n                children: \"\\u270F\\uFE0F Edit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 61,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 28\n            }, this) : 'Change Vote' : 'Vote'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 17\n          }, this), opt.text, \" \\u2014 \", votes, \" votes (\", percent, \"%)\"]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 15\n        }, this);\n      })]\n    }, poll._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n};\n_s(PollList, \"KtzQibcdPE9p2pwVeAS/JhcPm48=\");\n_c = PollList;\nexport default PollList;\nvar _c;\n$RefreshReg$(_c, \"PollList\");","map":{"version":3,"names":["React","useState","useEffect","axios","jwtDecode","jsxDEV","_jsxDEV","PollList","_s","polls","setPolls","get","then","res","data","handleVote","pollId","optionIndex","post","headers","role","localStorage","getItem","Authorization","alert","err","_err$response","_err$response$data","response","error","getUserIdFromToken","token","decoded","userId","_id","id","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","map","poll","border","borderRadius","margin","question","options","opt","idx","votes","length","totalVotes","reduce","sum","o","percent","toFixed","hasVoted","some","includes","votedThisOption","marginBottom","onClick","marginRight","background","color","fontWeight","cursor","display","alignItems","title","marginLeft","fontSize","opacity","text","_c","$RefreshReg$"],"sources":["C:/Users/ADMIN/Desktop/hyd/hyd/frontend/src/components/polls/PollList.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\nconst PollList = () => {\r\n  const [polls, setPolls] = useState([]);\r\n\r\n  useEffect(() => {\r\n    axios.get(\"http://localhost:5000/api/polls/all\").then(res => setPolls(res.data));\r\n  }, []);\r\n\r\n  const handleVote = async (pollId, optionIndex) => {\r\n    try {\r\n      await axios.post(`http://localhost:5000/api/polls/vote/${pollId}/${optionIndex}`, {}, {\r\n        headers: {\r\n          role: localStorage.getItem(\"role\"),\r\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\r\n        }\r\n      });\r\n      alert(\"Vote recorded!\");\r\n      const res = await axios.get(\"http://localhost:5000/api/polls/all\");\r\n      setPolls(res.data);\r\n    } catch (err) {\r\n      alert(err.response?.data?.error || \"Error voting\");\r\n    }\r\n  };\r\n\r\n  const getUserIdFromToken = () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return null;\r\n    try {\r\n      const decoded = jwtDecode(token);\r\n      return decoded.userId || decoded._id || decoded.id || null;\r\n    } catch {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: \"20px\" }}>\r\n      <h2>Available Polls</h2>\r\n      {polls.map((poll) => (\r\n        <div key={poll._id} style={{ border: \"1px solid #ddd\", borderRadius: \"8px\", margin: \"10px 0\", padding: \"10px\" }}>\r\n          <h3>{poll.question}</h3>\r\n          {poll.options.map((opt, idx) => {\r\n            const votes = opt.votes.length;\r\n            const totalVotes = poll.options.reduce((sum, o) => sum + o.votes.length, 0);\r\n            const percent = totalVotes > 0 ? ((votes / totalVotes) * 100).toFixed(1) : 0;\r\n            const userId = getUserIdFromToken();\r\n            const hasVoted = poll.options.some(o => o.votes.includes(userId));\r\n            const votedThisOption = opt.votes.includes(userId);\r\n\r\n            return (\r\n              <div key={idx} style={{ marginBottom: \"5px\" }}>\r\n                <button\r\n                  onClick={() => handleVote(poll._id, idx)}\r\n                  style={{ marginRight: \"10px\", background: votedThisOption ? '#388e3c' : '#1976d2', color: '#fff', border: 'none', borderRadius: '6px', fontWeight: 600, cursor: 'pointer', display: 'flex', alignItems: 'center' }}\r\n                >\r\n                  {hasVoted\r\n                    ? (votedThisOption\r\n                        ? (<span>Voted <span title=\"Edit Vote\" style={{ marginLeft: 8, fontSize: '1.1em', opacity: 0.7 }}>✏️ Edit</span></span>)\r\n                        : 'Change Vote')\r\n                    : 'Vote'}\r\n                </button>\r\n                {opt.text} — {votes} votes ({percent}%)\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PollList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}